--RETRIVING THE DATA FROM STUDENTS

SELECT * FROM STUDENTS;

--CREATING THE VIEW ON THE STUDENTS TABLE
CREATE VIEW STUDENT
AS
SELECT * FROM STUDENTS;

--RETRIVING THE VIEW
SELECT * FROM STUDENT;

--SECURITY
CREATE ROLE RUDHRA
LOGIN
PASSWORD 'RUDHRA';

--HERE IT IS ACCESS
GRANT SELECT ON STUDENT TO RUDHRA;

--SECURITY QUERY
SELECT * FROM STUDENT;

--CREATE OR REPLACE VIEWS
--cannot change name of view column "address" to "add".
--cannot change data type of view column "student_id" from integer to bigint 

SELECT *  FROM STUDENTS;

CREATE OR REPLACE VIEW STUDENT1
AS 
SELECT STUDENT_ID,FIRST_NAME,ADDRESS AS ADD --cannot change name of view column "address" to "add"
FROM STUDENTS;


CREATE OR REPLACE VIEW STUDENT1
AS 
SELECT STUDENT_ID::BIGINT,FIRST_NAME,ADDRESS --cannot change data type of view column "student_id" from integer to bigint
FROM STUDENTS;

SELECT * FROM STUDENT1;

--ADD COLUMN TO THE VIEW 
--cannot change name of view column "address" to "phone"
CREATE OR REPLACE VIEW STUDENT1
AS 
SELECT STUDENT_ID,FIRST_NAME,PHONE,ADDRESS --cannot change name of view column "address" to "phone"
FROM STUDENTS;


--WE CANNOT ADD A COLUMN AS ABOVE BUT IF WANT TO ADD A COLUMN AT THE LAST COLUMN WE CAN ADD THE NEW COLUMN
CREATE OR REPLACE VIEW STUDENT1
AS 
SELECT STUDENT_ID,FIRST_NAME,ADDRESS,PHONE
FROM STUDENTS;

--CHANGE THE NAME OF VIEW_COLUMN
ALTER VIEW STUDENT1
RENAME COLUMN PHONE TO CONTACT;

SELECT * FROM STUDENT1;

--CHANGE THE NAME OF VIEW TABLE NAME
ALTER VIEW STUDENT1
RENAME TO STUDENT_1;

SELECT * FROM STUDENT_1;

--TO DROP VIEW NAME
DROP VIEW STUDENT_1;

CREATE VIEW BIRTHDAY
AS
SELECT * FROM STUDENTS
WHERE DATE_OF_BIRTH > '01-01-2003';

CREATE OR REPLACE VIEW BIRTHDAY
AS
SELECT * FROM STUDENTS
WHERE DATE_OF_BIRTH > '01-01-2003';

SELECT * FROM BIRTHDAY;

ALTER TABLE STUDENTS 
ADD COLUMN AGE INT;

SELECT * FROM STUDENTS;

INSERT INTO STUDENTS
VALUES(11,'Rohit','Sharma','2003-04-30','Male','rohitsharma45@gmail.com',9966026431,'Mumbai',null);

--UPDATABLE VIEWS
SELECT * FROM STUDENTS;

UPDATE BIRTHDAY
SET FIRST_NAME='Shreyas'
WHERE STUDENT_ID=8;

SELECT * FROM BIRTHDAY;

--WITH CHECK OPTION

CREATE OR REPLACE VIEW LOCATION
AS
SELECT * FROM STUDENTS
WHERE ADDRESS = 'Mumbai'
WITH CHECK OPTION;

INSERT INTO STUDENTS
VALUES(12,'Rohit','Yadav','2003-09-30','Male','rohityadav45@gmail.com',9966026413,'Hyderabad',null);

INSERT INTO STUDENTS
VALUES(14,'Suryakumar','Yadav','2003-09-30','Male','rohityadav45@gmail.com',9966026413,'Hyderabad',null);

INSERT INTO STUDENTS
VALUES(14,'Suryakumar','Shrama','2003-09-30','Male','rohityadav45@gmail.com',9966026413,'Hyderabad',null);

SELECT * FROM LOCATION;


